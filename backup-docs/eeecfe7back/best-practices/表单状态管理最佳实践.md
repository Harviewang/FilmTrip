# è¡¨å•çŠ¶æ€ç®¡ç†æœ€ä½³å®è·µ

## ğŸ“‹ é—®é¢˜èƒŒæ™¯

åœ¨å¤šä¸ªè¡¨å•ï¼ˆä¸Šä¼ ã€ç¼–è¾‘ã€æ‰¹é‡ä¸Šä¼ ç­‰ï¼‰å…±å­˜çš„ç»„ä»¶ä¸­ï¼Œç»å¸¸å‡ºç°ä»¥ä¸‹é—®é¢˜ï¼š

1. **çŠ¶æ€æ±¡æŸ“**ï¼šä¸€ä¸ªè¡¨å•çš„æ“ä½œå½±å“å¦ä¸€ä¸ªè¡¨å•çš„çŠ¶æ€
2. **é‡å¤ä»£ç **ï¼šæ¯ä¸ªè¡¨å•éƒ½éœ€è¦ç‹¬ç«‹çš„åˆå§‹åŒ–ã€é‡ç½®é€»è¾‘
3. **éš¾ä»¥ç»´æŠ¤**ï¼šçŠ¶æ€åˆ†æ•£ï¼Œéš¾ä»¥ç»Ÿä¸€ç®¡ç†

## âœ… è§£å†³æ–¹æ¡ˆ

### 1. ä½¿ç”¨ `useFormState` Hookï¼ˆæ¨èï¼‰

é€‚ç”¨äºå•ä¸ªè¡¨å•çš„åœºæ™¯ã€‚

```jsx
import { useFormState } from '../hooks/useFormState';

const MyComponent = () => {
  // å®šä¹‰è¡¨å•åˆå§‹å€¼
  const initialValues = {
    title: '',
    description: '',
    file: null,
    is_protected: false
  };

  // ä½¿ç”¨Hookç®¡ç†è¡¨å•çŠ¶æ€
  const [form, formHandlers] = useFormState(initialValues);

  // æ›´æ–°å•ä¸ªå­—æ®µ
  const handleInputChange = (field, value) => {
    formHandlers.setField(field, value);
  };

  // é‡ç½®è¡¨å•
  const handleReset = () => {
    formHandlers.reset();
  };

  return (
    <form>
      <input 
        value={form.title} 
        onChange={(e) => handleInputChange('title', e.target.value)} 
      />
      <button onClick={handleReset}>é‡ç½®</button>
    </form>
  );
};
```

### 2. ä½¿ç”¨ `useMultipleForms` Hook

é€‚ç”¨äºåŒä¸€ç»„ä»¶ä¸­æœ‰å¤šä¸ªè¡¨å•çš„åœºæ™¯ã€‚

```jsx
import { useMultipleForms } from '../hooks/useFormState';

const PhotoManagement = () => {
  const { forms, handlers } = useMultipleForms({
    // ä¸Šä¼ è¡¨å•
    upload: {
      title: '',
      description: '',
      file: null,
      is_protected: false
    },
    // ç¼–è¾‘è¡¨å•
    edit: {
      title: '',
      description: '',
      is_protected: false
    },
    // æ‰¹é‡ä¸Šä¼ è¡¨å•
    batch: {
      film_roll_id: '',
      files: [],
      is_protected: false
    }
  });

  const handleUpload = async () => {
    // ä½¿ç”¨ forms.upload è®¿é—®ä¸Šä¼ è¡¨å•æ•°æ®
    console.log(forms.upload);
    
    // æäº¤åé‡ç½®
    handlers.upload.reset();
  };

  const handleEdit = async () => {
    // ä½¿ç”¨ forms.edit è®¿é—®ç¼–è¾‘è¡¨å•æ•°æ®
    console.log(forms.edit);
    
    // æäº¤åé‡ç½®
    handlers.edit.reset();
  };

  // ç¼–è¾‘æ—¶ï¼Œå¡«å……è¡¨å•æ•°æ®
  const handleEditClick = (photo) => {
    handlers.edit.replace({
      title: photo.title,
      description: photo.description,
      is_protected: photo.is_protected
    });
  };

  return (
    <div>
      {/* ä¸Šä¼ è¡¨å• */}
      <UploadForm 
        form={forms.upload} 
        onChange={handlers.upload.setField}
      />
      
      {/* ç¼–è¾‘è¡¨å• */}
      <EditForm 
        form={forms.edit}
        onChange={handlers.edit.setField}
      />
    </div>
  );
};
```

## ğŸ¯ æ ¸å¿ƒä¼˜åŠ¿

### 1. **çŠ¶æ€éš”ç¦»**
æ¯ä¸ªè¡¨å•çš„çŠ¶æ€å®Œå…¨ç‹¬ç«‹ï¼Œäº’ä¸å¹²æ‰°ã€‚

### 2. **ä»£ç å¤ç”¨**
ç»Ÿä¸€çš„è¡¨å•ç®¡ç†é€»è¾‘ï¼Œå‡å°‘é‡å¤ä»£ç ã€‚

### 3. **æ˜“äºç»´æŠ¤**
çŠ¶æ€ç®¡ç†é€»è¾‘é›†ä¸­ï¼Œä¾¿äºè°ƒè¯•å’Œç»´æŠ¤ã€‚

### 4. **ç±»å‹å®‰å…¨**
é€šè¿‡JSDocæ³¨é‡Šæä¾›å®Œæ•´çš„ç±»å‹æç¤ºã€‚

## ğŸ“ ä½¿ç”¨æŒ‡å—

### åˆå§‹åŒ–è¡¨å•

```jsx
// å®šä¹‰åˆå§‹å€¼
const initialValues = {
  name: '',
  email: '',
  age: 0,
  avatar: null
};

// ä½¿ç”¨Hook
const [form, handlers] = useFormState(initialValues);
```

### æ›´æ–°å­—æ®µ

```jsx
// æ–¹å¼1ï¼šå•ä¸ªå­—æ®µæ›´æ–°
handlers.setField('name', 'John');

// æ–¹å¼2ï¼šæ‰¹é‡æ›´æ–°
handlers.setFields({
  name: 'John',
  email: 'john@example.com'
});
```

### é‡ç½®è¡¨å•

```jsx
// é‡ç½®ä¸ºåˆå§‹å€¼
handlers.reset();

// é‡ç½®ä¸ºæŒ‡å®šå€¼
handlers.reset({ name: 'Default Name' });
```

### å®Œæ•´æ›¿æ¢

```jsx
// å®Œå…¨æ›¿æ¢è¡¨å•çŠ¶æ€ï¼ˆé€‚ç”¨äºç¼–è¾‘åœºæ™¯ï¼‰
const photo = { title: 'Photo 1', description: 'Desc' };
handlers.replace(photo);
```

## ğŸ”„ è¿ç§»æŒ‡å—

### ä»ä¼ ç»Ÿæ–¹å¼è¿ç§»

**ä¹‹å‰çš„ä»£ç ï¼š**
```jsx
const [uploadForm, setUploadForm] = useState({
  title: '',
  file: null
});

const resetUploadForm = () => {
  setUploadForm({
    title: '',
    file: null
  });
};

// æ›´æ–°å­—æ®µ
setUploadForm({ ...uploadForm, title: 'New Title' });
```

**è¿ç§»åçš„ä»£ç ï¼š**
```jsx
const [uploadForm, uploadHandlers] = useFormState({
  title: '',
  file: null
});

// é‡ç½®è¡¨å•
uploadHandlers.reset();

// æ›´æ–°å­—æ®µ
uploadHandlers.setField('title', 'New Title');
```

## âš ï¸ æ³¨æ„äº‹é¡¹

### 1. åˆå§‹å€¼å®šä¹‰
ç¡®ä¿åˆå§‹å€¼ä¸è¡¨å•å­—æ®µå®Œå…¨å¯¹åº”ï¼Œé¿å…é—æ¼å­—æ®µã€‚

```jsx
// âŒ ä¸å¥½ï¼šé—æ¼å­—æ®µ
const [form, handlers] = useFormState({
  name: '',
  // ç¼ºå°‘ email å­—æ®µ
});

// âœ… å¥½ï¼šå®Œæ•´çš„åˆå§‹å€¼
const [form, handlers] = useFormState({
  name: '',
  email: '',
  age: 0
});
```

### 2. æ–‡ä»¶ä¸Šä¼ å­—æ®µ
æ–‡ä»¶ç±»å‹çš„å­—æ®µåˆå§‹å€¼åº”ä¸º `null` è€Œä¸æ˜¯ç©ºå­—ç¬¦ä¸²ã€‚

```jsx
const [form, handlers] = useFormState({
  title: '',
  file: null,  // âœ… æ–‡ä»¶å­—æ®µä½¿ç”¨ null
  avatar: null // âœ… å›¾ç‰‡å­—æ®µä½¿ç”¨ null
});
```

### 3. å¸ƒå°”å€¼å­—æ®µ
å¸ƒå°”å€¼å­—æ®µåˆå§‹å€¼åº”è¯¥æ˜¯ `false` è€Œä¸æ˜¯ç©ºå­—ç¬¦ä¸²ã€‚

```jsx
const [form, handlers] = useFormState({
  is_protected: false,  // âœ… å¸ƒå°”å€¼ä½¿ç”¨ false
  is_public: false
});
```

## ğŸ¨ å®é™…åº”ç”¨ç¤ºä¾‹

å‚è€ƒé¡¹ç›®ä¸­çš„ `frontend/src/views/PhotoManagement.jsx` æ–‡ä»¶ï¼ŒæŸ¥çœ‹å®Œæ•´çš„ä½¿ç”¨ç¤ºä¾‹ã€‚

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [React Hooks å®˜æ–¹æ–‡æ¡£](https://react.dev/reference/react)
- [useCallback Hook](https://react.dev/reference/react/useCallback)
- [useState Hook](https://react.dev/reference/react/useState)

