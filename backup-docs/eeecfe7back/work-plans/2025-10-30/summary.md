# 2025-10-30 工作计划

## 1. 上线前重点任务
- **胶卷模式体验**：设计并实现按胶卷聚合的浏览入口（胶卷故事、关键信息、快速切换）。输出交互稿、所需接口、前端入口（预计 `/rolls` 或 `/gallery?view=roll`）。
- **随机模式 2.0**：支持全局/跨胶卷随机，统一桌面/移动端动效，保留现有“单卷随机”作为子模式；整理需求文档与技术方案。
- **CDN & 防护方案**：完成静态资源与瓦片 CDN 配置、防盗链和限流策略，引入 Geomaply→MapTiler→OSM 的供应商降级链，并评估设备限额上调；同步监控/告警、熔断方案。
- **地图批量补录（M-8）**：后台多选 → 一次选点 → 批量写入。需交互稿、批量更新 API、权限/限流策略及回滚流程。
- **`location_name` 退役（M-9）**：梳理 DB/后端/前端引用，设计迁移脚本（备份→清理→验证）与回滚方案，更新规格验收。
- **QA 基线（QA-1）**：补齐 10-28 地图回归手测记录，并新增自动化测试用例（逆地理编码成功/失败、MapLibre 标记渲染、预览弹窗流程）。

## 2. 任务拆解

| 编号 | 模块 | 任务摘要 | 负责人 | 状态 | 备注 |
| --- | --- | --- | --- | --- | --- |
| R-1 | 胶卷模式 | 产出胶卷模式交互稿、接口需求、前端实现计划 | Codex→AI助手 | ⏳ 待启动 | 涉及 `/gallery` / `/rolls` 入口设计与数据结构调整 |
| R-2 | 随机模式 2.0 | 全局随机设计与实现计划 | Codex→AI助手 | ⏳ 待启动 | 解决“仅单卷随机”限制，统一移动/桌面端动效 |
| INF-1 | CDN&防护 | 静态资源 CDN、防盗链、限流、Geomaply 降级链方案 | Codex→AI助手 | ⏳ 待启动 | 需配置 Geomaply→MapTiler→OSM 降级，评估设备限额上调 |
| M-8 | 地图·批量 | 批量标点补录工具（后台多选→统一选点） | AI助手 | ⏳ 待启动 | 绘制流程、前后端任务拆分、性能/权限策略 |
| M-9 | 数据模型 | `location_name` 字段迁移与退役 | AI助手 | ⏳ 待启动 | 输出迁移脚本、回滚方案、规格更新 |
| QA-1 | 测试 | 地图链路回归（手测 + 自动化） | AI助手 | ⏳ 待启动 | 覆盖矢量/栅格/OSM、预览、批量上传等核心流程 |

## 3. 验收清单
- [ ] 胶卷模式交互与接口方案敲定，并创建实施任务。
- [ ] 随机模式 2.0 需求与技术方案评审通过。
- [ ] CDN/防护方案（Geomaply 降级、配额策略、防盗链、告警）完成并记录。
- [ ] M-8 批量选点工具的交互稿、API 设计、权限策略确定。
- [ ] M-9 迁移脚本（含回滚）与规格文档更新。
- [ ] QA-1 回归计划执行：记录手测结果、补充自动化测试。

## 4. 待办与依赖
- 更新 `docs/specifications/需求文档-统一版.md` 的地点字段统一化章节，写入 M-8/M-9 的验收标准与接口清单。
- 将 Geomaply 接入方案、地图聚合需求移动至需求池并标记优先级。
- 收集胶卷模式与随机模式的现有痛点或用户反馈，作为设计输入。

## 5. 参考资料
- `docs/work-plans/2025-10-29/summary.md`
- `docs/work-plans/2025-10-28/完整方案-地图中文地址增强.md`
- `docs/specifications/需求文档-统一版.md`
- `docs/knowledge-base/best-practices/地图中文地点增强最佳实践-2025-10-28.md`
