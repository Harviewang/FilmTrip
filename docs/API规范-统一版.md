# APIè§„èŒƒ-ç»Ÿä¸€ç‰ˆ

**åˆ›å»ºæ—¥æœŸ**ï¼š2025-10-24  
**ç‰ˆæœ¬**ï¼šv1.0.0  
**é€‚ç”¨èŒƒå›´**ï¼šFilmTripé¡¹ç›®æ‰€æœ‰APIæ¥å£

## ğŸ“‹ è§„èŒƒæ¦‚è¿°

æœ¬æ–‡æ¡£å®šä¹‰äº†FilmTripé¡¹ç›®æ‰€æœ‰APIæ¥å£çš„ç»Ÿä¸€è¿”å›æ ¼å¼è§„èŒƒï¼Œæ—¨åœ¨è§£å†³æ¥å£æ ¼å¼ä¸ä¸€è‡´ã€`data.data`åæ¨¡å¼ç­‰é—®é¢˜ã€‚

## ğŸ¯ æ ¸å¿ƒåŸåˆ™

1. **é¿å… `data.data` åæ¨¡å¼**ï¼šç¦æ­¢ä½¿ç”¨åµŒå¥—çš„dataå­—æ®µ
2. **è¯­ä¹‰æ˜ç¡®**ï¼šå­—æ®µåå…·æœ‰æ˜ç¡®çš„ä¸šåŠ¡å«ä¹‰
3. **æ ¼å¼ç»Ÿä¸€**ï¼šæ‰€æœ‰APIä½¿ç”¨ç›¸åŒçš„è¿”å›ç»“æ„
4. **å‘åå…¼å®¹**ï¼šä¿æŒç°æœ‰åŠŸèƒ½ä¸å—å½±å“

## ğŸ“Š æ ‡å‡†è¿”å›æ ¼å¼

### åŸºç¡€æ ¼å¼
```javascript
{
  success: boolean,        // è¯·æ±‚æ˜¯å¦æˆåŠŸ
  message?: string,        // å¯é€‰çš„é”™è¯¯ä¿¡æ¯æˆ–æˆåŠŸæç¤º
  data?: any,             // ä¸šåŠ¡æ•°æ®ï¼ˆå¯é€‰ï¼‰
  pagination?: {          // åˆ†é¡µä¿¡æ¯ï¼ˆå¯é€‰ï¼‰
    page: number,         // å½“å‰é¡µç 
    limit: number,        // æ¯é¡µæ•°é‡
    total: number,        // æ€»æ•°é‡
    pages: number         // æ€»é¡µæ•°
  }
}
```

### æˆåŠŸå“åº”ç¤ºä¾‹

**1. åˆ—è¡¨æ•°æ®ï¼ˆå¸¦åˆ†é¡µï¼‰**
```javascript
// GET /api/filmStocks
{
  "success": true,
  "filmStocks": [
    {
      "id": "uuid",
      "brand": "Kodak",
      "series": "Portra",
      "iso": 400,
      "format": "135",
      "type": "color"
    }
  ],
  "pagination": {
    "page": 1,
    "limit": 20,
    "total": 100,
    "pages": 5
  }
}
```

**2. å•ä¸ªæ•°æ®**
```javascript
// GET /api/filmStocks/:id
{
  "success": true,
  "filmStock": {
    "id": "uuid",
    "brand": "Kodak",
    "series": "Portra",
    "iso": 400,
    "format": "135",
    "type": "color"
  }
}
```

**3. æ“ä½œç»“æœ**
```javascript
// POST /api/filmStocks
{
  "success": true,
  "message": "èƒ¶å·å“ç±»åˆ›å»ºæˆåŠŸ",
  "filmStock": {
    "id": "uuid",
    "brand": "Kodak",
    "series": "Portra"
  }
}
```

### é”™è¯¯å“åº”ç¤ºä¾‹

**1. ä¸šåŠ¡é”™è¯¯**
```javascript
{
  "success": false,
  "message": "èƒ¶å·å“ç±»å·²å­˜åœ¨",
  "code": "DUPLICATE_STOCK"
}
```

**2. éªŒè¯é”™è¯¯**
```javascript
{
  "success": false,
  "message": "å‚æ•°éªŒè¯å¤±è´¥",
  "errors": [
    {
      "field": "brand",
      "message": "å“ç‰Œä¸èƒ½ä¸ºç©º"
    }
  ]
}
```

## ğŸ”§ å­—æ®µå‘½åè§„èŒƒ

### æ•°æ®å­—æ®µå‘½å
- **åˆ—è¡¨æ•°æ®**ï¼šä½¿ç”¨å¤æ•°å½¢å¼ï¼Œå¦‚ `filmStocks`ã€`photos`ã€`cameras`
- **å•ä¸ªæ•°æ®**ï¼šä½¿ç”¨å•æ•°å½¢å¼ï¼Œå¦‚ `filmStock`ã€`photo`ã€`camera`
- **åˆ†é¡µä¿¡æ¯**ï¼šç»Ÿä¸€ä½¿ç”¨ `pagination`
- **é”™è¯¯ä¿¡æ¯**ï¼šç»Ÿä¸€ä½¿ç”¨ `message`

### é¿å…çš„åæ¨¡å¼
âŒ **ç¦æ­¢ä½¿ç”¨**ï¼š
```javascript
{
  "success": true,
  "data": {
    "data": [...],           // åµŒå¥—dataå­—æ®µ
    "pagination": {...}
  }
}
```

âœ… **æ¨èä½¿ç”¨**ï¼š
```javascript
{
  "success": true,
  "filmStocks": [...],       // ç›´æ¥ä½¿ç”¨ä¸šåŠ¡å­—æ®µå
  "pagination": {...}
}
```

## ğŸ“ æ¥å£åˆ†ç±»è§„èŒƒ

### 1. åˆ—è¡¨æ¥å£
- **è·¯å¾„**ï¼š`GET /api/{resource}`
- **è¿”å›**ï¼š`{resource}s` + `pagination`
- **ç¤ºä¾‹**ï¼š`GET /api/filmStocks` â†’ `filmStocks` + `pagination`

### 2. è¯¦æƒ…æ¥å£
- **è·¯å¾„**ï¼š`GET /api/{resource}/:id`
- **è¿”å›**ï¼š`{resource}`
- **ç¤ºä¾‹**ï¼š`GET /api/filmStocks/:id` â†’ `filmStock`

### 3. åˆ›å»ºæ¥å£
- **è·¯å¾„**ï¼š`POST /api/{resource}`
- **è¿”å›**ï¼š`{resource}` + `message`
- **ç¤ºä¾‹**ï¼š`POST /api/filmStocks` â†’ `filmStock` + `message`

### 4. æ›´æ–°æ¥å£
- **è·¯å¾„**ï¼š`PUT /api/{resource}/:id`
- **è¿”å›**ï¼š`{resource}` + `message`
- **ç¤ºä¾‹**ï¼š`PUT /api/filmStocks/:id` â†’ `filmStock` + `message`

### 5. åˆ é™¤æ¥å£
- **è·¯å¾„**ï¼š`DELETE /api/{resource}/:id`
- **è¿”å›**ï¼š`message`
- **ç¤ºä¾‹**ï¼š`DELETE /api/filmStocks/:id` â†’ `message`

## ğŸ› ï¸ å®æ–½æŒ‡å—

### åç«¯ä¿®æ”¹æ­¥éª¤
1. ä¿®æ”¹æ§åˆ¶å™¨è¿”å›æ ¼å¼
2. ç¡®ä¿æ‰€æœ‰æ¥å£éµå¾ªç»Ÿä¸€æ ¼å¼
3. æ·»åŠ é”™è¯¯å¤„ç†
4. æ›´æ–°APIæ–‡æ¡£

### å‰ç«¯ä¿®æ”¹æ­¥éª¤
1. æ›´æ–°APIè°ƒç”¨ä»£ç 
2. ç»Ÿä¸€æ•°æ®å¤„ç†é€»è¾‘
3. æ·»åŠ é”™è¯¯å¤„ç†
4. æ›´æ–°TypeScriptç±»å‹å®šä¹‰

### æµ‹è¯•éªŒè¯
1. å•å…ƒæµ‹è¯•ï¼šéªŒè¯è¿”å›æ ¼å¼
2. é›†æˆæµ‹è¯•ï¼šéªŒè¯å‰åç«¯äº¤äº’
3. æ‰‹åŠ¨æµ‹è¯•ï¼šéªŒè¯æ‰€æœ‰åŠŸèƒ½æ­£å¸¸

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [åç«¯APIå®ç°æŒ‡å—](./backend-api-guide.md)
- [å‰ç«¯APIè°ƒç”¨æŒ‡å—](./frontend-api-guide.md)
- [é”™è¯¯å¤„ç†è§„èŒƒ](./error-handling-guide.md)

## ğŸ”„ ç‰ˆæœ¬å†å²

- **v1.0.0** (2025-10-24)ï¼šåˆå§‹ç‰ˆæœ¬ï¼Œè§£å†³`data.data`åæ¨¡å¼é—®é¢˜

---

**é‡è¦æé†’**ï¼šæœ¬è§„èŒƒä¸ºå¼ºåˆ¶æ€§è§„èŒƒï¼Œæ‰€æœ‰æ–°å¼€å‘çš„APIå¿…é¡»éµå¾ªæ­¤æ ¼å¼ï¼Œç°æœ‰APIéœ€è¦é€æ­¥è¿ç§»åˆ°æ–°æ ¼å¼ã€‚
