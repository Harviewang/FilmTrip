# FilmTrip 全局预览组件使用指南

## 🎯 组件概述

`PhotoPreview` 是一个全局通用的照片预览组件，为所有页面提供一致的照片预览体验。

## ✨ 主要特性

### 1. 全局通用性
- 支持所有页面的照片预览
- 一致的UI设计和交互体验
- 统一的键盘快捷键支持

### 2. 紧凑模式
- `compact={true}` 启用紧凑模式
- 减少底部信息高度
- 优化移动端显示效果

### 3. 丰富的信息显示
- 基本信息：相机、胶卷、日期
- 技术参数：ISO、光圈、快门、焦距
- 位置信息：地点名称或坐标
- 评分系统：星级显示

### 4. 智能交互
- UI显示/隐藏切换
- 照片导航（上一张/下一张）
- 键盘快捷键支持
- 响应式设计

## 🔧 使用方法

### 基本用法

```jsx
import PhotoPreview from '../components/PhotoPreview';

// 在组件中使用
<PhotoPreview
  photo={selectedPhoto}
  photos={photos}
  isOpen={showPreview}
  onClose={() => setShowPreview(false)}
  currentPath="/photos"
  showNavigation={true}
  showUI={true}
  onPhotoChange={handlePhotoChange}
  compact={false} // 可选：启用紧凑模式
/>
```

### 紧凑模式

```jsx
// 启用紧凑模式，减少信息高度
<PhotoPreview
  photo={selectedPhoto}
  photos={photos}
  isOpen={showPreview}
  onClose={() => setShowPreview(false)}
  compact={true} // 启用紧凑模式
/>
```

## 📱 响应式设计

### 桌面端
- 完整信息显示
- 3列网格布局
- 详细技术参数

### 移动端
- 紧凑信息显示
- 2列网格布局
- 触摸友好交互

## ⌨️ 键盘快捷键

| 按键 | 功能 |
|------|------|
| `ESC` | 关闭预览 |
| `H` | 切换UI显示/隐藏 |
| `←` | 上一张照片 |
| `→` | 下一张照片 |

## 🎨 自定义配置

### 显示选项

```jsx
<PhotoPreview
  // 基本配置
  photo={photo}
  photos={photos}
  isOpen={isOpen}
  onClose={onClose}
  
  // 可选配置
  currentPath="/photos"           // 当前页面路径
  showNavigation={true}           // 显示导航按钮
  showUI={true}                   // 初始UI显示状态
  compact={false}                 // 紧凑模式
  onPhotoChange={handleChange}    // 照片切换回调
/>
```

### 回调函数

```jsx
// 照片切换回调
const handlePhotoChange = (newPhoto, newIndex) => {
  console.log('切换到照片:', newPhoto.title, '索引:', newIndex);
  // 更新URL参数
  navigate(`?photo=${newPhoto.id}`);
};

// 关闭回调
const handleClose = () => {
  setShowPreview(false);
  // 清理URL参数
  navigate(currentPath, { replace: true });
};
```

## 🔄 集成到现有页面

### 1. Photos页面

```jsx
// 替换现有的预览逻辑
<PhotoPreview
  photo={selectedPhoto}
  photos={photos}
  isOpen={showPreview}
  onClose={() => setShowPreview(false)}
  currentPath="/photos"
  showNavigation={true}
  compact={true} // 启用紧凑模式
/>
```

### 2. Map页面

```jsx
// 地图页面预览
<PhotoPreview
  photo={selectedPhoto}
  photos={mapPhotos}
  isOpen={showPreview}
  onClose={() => setShowPreview(false)}
  currentPath="/map"
  showNavigation={false} // 地图页面可能不需要导航
  compact={true}
/>
```

### 3. FilmRolls页面

```jsx
// 胶卷页面预览
<PhotoPreview
  photo={selectedPhoto}
  photos={filmRollPhotos}
  isOpen={showPreview}
  onClose={() => setShowPreview(false)}
  currentPath="/film-rolls"
  showNavigation={true}
  compact={false} // 胶卷页面保持完整显示
/>
```

## 🎯 最佳实践

### 1. 数据准备
- 确保照片对象包含必要的字段
- 提供完整的照片数组用于导航
- 包含原始数据用于调试

### 2. 状态管理
- 使用本地状态管理预览开关
- 实现照片切换逻辑
- 处理URL参数同步

### 3. 性能优化
- 懒加载照片数据
- 避免不必要的重渲染
- 优化图片加载

## 🐛 常见问题

### Q: 照片信息显示不完整？
A: 检查照片对象是否包含 `_raw` 字段，包含完整的后端数据。

### Q: 导航按钮不显示？
A: 确保 `photos` 数组长度大于1，且 `showNavigation={true}`。

### Q: 紧凑模式效果不明显？
A: 紧凑模式主要影响信息布局，确保 `compact={true}` 已设置。

### Q: 键盘快捷键不工作？
A: 确保组件已挂载且 `isOpen={true}`，检查是否有其他事件监听器冲突。

## 📚 相关文档

- [PhotoPreview组件源码](../frontend/src/components/PhotoPreview.jsx)
- [前端设计规范](./前端设计规范.md)
- [自适应设计指南](./自适应设计指南.md)

---

**最后更新**: 2025-01-22  
**更新人**: 前端开发工程师
