# FilmTrip 项目文件整理指南

## 项目概述

FilmTrip是一个专业的胶片摄影管理系统，采用三层清晰结构设计，避免层级过深，保持逻辑简单。

> 📖 **相关文档**：[需求文档](./需求文档-统一版.md) | [数据库设计](./数据库设计.md) | [开发计划](./开发计划.md)

## 核心设计理念

> 💡 **详细设计说明**请参考：[需求文档](./需求文档-统一版.md) 和 [数据库设计](./数据库设计.md)

### 1. 三层清晰结构
- **胶卷品类 (Film Stock)** → **胶卷实例 (Film Roll)** → **照片 (Photo)**
- 避免层级过深，保持逻辑简单
- 每层职责明确，易于理解和维护

### 2. 继承关系
- 照片继承胶卷实例的所有属性
- 胶卷实例继承胶卷品类的所有属性
- 减少数据冗余，提高数据完整性

### 3. 实际业务导向
- 一卷胶卷天然就是一个照片集合
- 不需要额外的相册概念
- 符合胶片摄影的实际工作流程

## 目录结构

```
FilmTrip/
├── backend/                 # 后端服务
│   ├── controllers/        # 控制器层
│   │   ├── filmStockController.js    # 胶卷品类管理
│   │   ├── filmRollController.js     # 胶卷实例管理
│   │   ├── photoController.js        # 照片管理
│   │   ├── cameraController.js       # 相机管理
│   │   ├── scannerController.js      # 扫描仪管理
│   │   ├── userController.js         # 用户管理
│   │   └── statsController.js        # 统计功能
│   ├── models/            # 数据模型层
│   │   ├── db.js          # 数据库连接和初始化
│   │   └── migrations/    # 数据库迁移脚本
│   ├── routes/            # 路由层
│   │   ├── filmStocks.js  # 胶卷品类路由
│   │   ├── filmRolls.js   # 胶卷实例路由
│   │   ├── photos.js      # 照片路由
│   │   ├── cameras.js     # 相机路由
│   │   ├── scanners.js    # 扫描仪路由
│   │   ├── users.js       # 用户路由
│   │   └── stats.js       # 统计路由
│   ├── middleware/        # 中间件
│   │   ├── auth.js        # 认证中间件
│   │   ├── adminAuth.js   # 管理员权限中间件
│   │   └── errorHandler.js # 错误处理中间件
│   ├── utils/             # 工具函数
│   │   ├── exif.js        # EXIF数据提取
│   │   ├── imageProcessor.js # 图片处理
│   │   └── upyun.js       # 云存储集成
│   ├── uploads/           # 上传文件存储
│   │   └── thumbnails/    # 缩略图存储
│   ├── data/              # 数据库文件
│   ├── index.js           # 主服务器文件
│   ├── package.json       # 依赖配置
│   └── .env               # 环境变量
├── frontend/              # 前端应用
│   ├── src/
│   │   ├── components/    # 通用组件
│   │   ├── views/         # 页面组件
│   │   │   ├── admin/     # 管理页面
│   │   │   │   ├── Dashboard.jsx           # 仪表板
│   │   │   │   ├── FilmStockManagement.jsx # 胶卷品类管理
│   │   │   │   ├── FilmRollManagement.jsx  # 胶卷实例管理
│   │   │   │   ├── PhotoManagement.jsx     # 照片管理
│   │   │   │   ├── CameraManagement.jsx    # 相机管理
│   │   │   │   ├── ScannerManagement.jsx   # 扫描仪管理
│   │   │   │   └── UserManagement.jsx      # 用户管理
│   │   │   ├── Login.jsx  # 登录页面
│   │   │   └── NotFound.jsx # 404页面
│   │   ├── services/      # API服务
│   │   ├── store/         # 状态管理
│   │   ├── utils/         # 工具函数
│   │   └── App.jsx        # 主应用组件
│   ├── public/            # 静态资源
│   ├── package.json       # 依赖配置
│   └── vite.config.js     # Vite配置
├── docs/                  # 项目文档
│   ├── README.md          # 文档索引
│   ├── 需求文档-统一版.md  # 产品需求规格
│   ├── 开发计划.md        # 项目执行计划
│   ├── 数据库设计.md      # 数据库设计文档
│   ├── 项目文件整理指南.md # 本文档
│   ├── 开发日志.md        # 开发过程记录
│   ├── BACKUP.md          # 备份操作指南
│   └── STORAGE_NAMING.md  # 存储命名规范
├── scripts/               # 脚本文件
│   ├── start-smart.sh     # 智能启动脚本
│   ├── stop-services.sh   # 服务停止脚本
│   └── backup/            # 备份脚本
└── README.md              # 项目说明
```

## 数据库表结构

> 🗄️ **详细数据库设计**请参考：[数据库设计文档](./数据库设计.md)

### 1. 胶卷品类表 (film_stocks)
- 存储所有胶卷的基础信息
- 字段：id, brand, series, iso, format, type, description, created_at, updated_at

### 2. 胶卷实例表 (film_rolls)
- 存储具体的一卷胶卷
- 继承胶卷品类属性，添加实例特有属性
- 字段：id, film_stock_id, roll_number, name, opened_date, location, camera_id, developed_date, developer, development_method, scanner_id, is_encrypted, status, notes, created_at, updated_at

### 3. 照片表 (photos)
- 存储具体照片
- 继承胶卷实例的所有属性，添加照片特有属性
- 字段：id, film_roll_id, photo_number, filename, original_name, title, description, taken_date, camera_id, aperture, shutter_speed, focal_length, iso, latitude, longitude, location_name, rating, is_encrypted, tags, uploaded_at, updated_at

### 4. 相机表 (cameras)
- 存储相机设备信息
- 字段：id, name, model, brand, type, format, description, created_at, updated_at

### 5. 扫描仪表 (scanners)
- 存储扫描仪设备信息
- 字段：id, name, model, type, description, created_at, updated_at

### 6. 用户表 (users)
- 存储用户账户信息
- 字段：id, username, password, created_at, updated_at

## 文件命名规范

### 1. 后端文件
- 控制器：`[实体名]Controller.js` (如：`filmStockController.js`)
- 路由：`[实体名].js` (如：`filmStocks.js`)
- 模型：`[实体名].js` (如：`filmStock.js`)

### 2. 前端文件
- 页面组件：`[功能名]Management.jsx` (如：`FilmStockManagement.jsx`)
- 通用组件：`[组件名].jsx` (如：`PhotoCard.jsx`)
- 服务文件：`[功能名]Api.js` (如：`filmStockApi.js`)

### 3. 文档文件
- 使用中文命名，便于理解
- 按功能模块分类
- 保持文档结构清晰

## 开发规范

### 1. 代码组织
- 按功能模块组织代码
- 保持文件结构清晰
- 避免循环依赖

### 2. 命名规范
- 使用有意义的名称
- 保持命名风格一致
- 避免缩写和简写

### 3. 文档维护
- 及时更新开发日志
- 保持文档与代码同步
- 记录重要的设计决策

## 部署说明

### 1. 环境要求
- Node.js 18+
- SQLite 3
- 支持的文件系统

### 2. 启动步骤
1. 安装依赖：`npm install`
2. 配置环境变量：复制 `.env.example` 到 `.env`
3. 启动服务：`./start-smart.sh`

### 3. 访问地址
- 前端：http://localhost:3000
- 管理后台：http://localhost:3002
- 后端：http://localhost:3001

## 维护说明

### 1. 日常维护
- 定期检查日志文件
- 监控服务状态
- 备份重要数据

### 2. 故障排除
- 查看开发日志
- 检查服务状态
- 使用智能启动脚本

### 3. 版本管理
- 记录重要变更
- 保持文档同步
- 定期代码审查

## 相关文档

- **[需求文档](./需求文档-统一版.md)** - 产品需求规格说明书
- **[开发计划](./开发计划.md)** - 项目执行计划和时间线
- **[数据库设计](./数据库设计.md)** - 技术架构和数据模型
- **[开发日志](./开发日志.md)** - 开发过程记录和问题追踪

---

*本文档专注于项目结构和文件组织，业务需求请参考需求文档，技术设计请参考数据库设计文档*
 
