# MapTiler 配额优化方案（讨论稿）
> 提交人：用户  
> 当前状态：待讨论确认，讨论后需归档至 `docs/archive/` 或运维文档；在方案定稿前暂存于此。

---

## 1. 现状与问题
- MapTiler 月度额度使用率已达 **86%**，预计本周期内会触及上限。
- 若额度耗尽，将影响地图渲染、地理定位等依赖 MapTiler 的前端功能。
- 当前项目尚无自动限流或备用地图服务，存在停服风险。

---

## 2. 用户初步方案要点（待确认）
1. **使用优化**  
   - 对地图加载进行懒加载与缓存处理，减少冗余请求。  
   - 优化页面中地图组件的渲染触发条件，避免重复实例化。
2. **额度管理**  
   - 评估升级 MapTiler 套餐的成本与可持续性。  
   - 引入请求监控与告警，提前预警配额压力。
3. **替代/补充方案**  
   - 讨论是否切换或并行使用开源瓦片（如 OpenStreetMap + 自建 Tiles）或其他供应商。  
   - 评估自建缓存代理或静态瓦片生成的可行性。
4. **长期优化方向**  
   - 将地图功能按需拆分，未登录或非地图核心页面默认不加载地图。  
   - 对热点位置生成缓存快照，降低实时请求量。

---

## 3. 待讨论问题
- MapTiler 升级 vs. 替换供应商的成本、风险评估。
- 前端层面缓存策略、加载策略需哪些具体改动。
- 是否需要后端/运维侧配合（如代理缓存、定时任务）。
- 与地图相关的业务优先级，是否可以阶段性关闭部分功能。

---

## 4. 会议准备建议
- 收集当前调用量数据：每日请求数、流量峰值、主要入口页面。
- 统计其他第三方服务的配额状况，便于统一考量。
- 列出可能的替代服务（Mapbox、Google Maps、OpenMapTiles 等）的价格与政策。
- 准备前端实现层面的 workload 估算。

---

> ⚠️ 讨论完成后，请将定稿方案移动到合适的目录（如 `docs/archive/`、`docs/troubleshooting/` 或运维指南），并在本文件中注明归档位置。
