# CMT-20251025-001: 预览界面UI恢复

## 提交信息
- **提交时间**: 2025-10-25
- **提交类型**: fix
- **负责人**: Cursor AI
- **审计状态**: 待审计

## 背景
上午 windsurf 完成的预览界面 UI 优化被 Cursor 覆盖，需要根据恢复文档 `docs/work-plans/2025-10-25/cursor-recovery.md` 恢复所有改动。

## 修改内容

### 1. frontend/src/components/PhotoPreview.jsx
**背景样式恢复**:
- 将顶层容器背景改为静态低饱和度渐变：
  ```jsx
  background: 'linear-gradient(135deg, #e8f0f7 0%, #dce7f2 25%, #d0deec 50%, #c4d5e6 75%, #d0deec 100%)'
  ```
- 过渡只保留 `opacity 600ms cubic-bezier(0.4, 0, 0.2, 1)`
- 移除所有 `scale`、`translate-y-8` 等变换

**动画时长调整**:
- 列表→预览淡入时间改为 400ms
- 图片加载完成的 opacity 过渡：`transition: 'opacity 400ms cubic-bezier(0.4, 0, 0.2, 1)'`

**预览模式切换优化**:
- 工具栏/信息面板/导航按钮使用 500ms 过渡
- 添加 `pointer-events-none` 禁用交互
- 工具栏隐藏时：`opacity-0 -translate-y-4 pointer-events-none`
- 信息面板隐藏时：`opacity-0 translate-y-8 pointer-events-none`
- 导航按钮隐藏时：`opacity-0 translate-x-8 pointer-events-none`

**图片样式改动**:
- 使用 `maxWidth/maxHeight + auto` 替代固定 `width/height`
- 标准模式圆角改为 16px（原8px）
- 标准模式阴影改为四层叠加：
  ```jsx
  boxShadow: '0 32px 64px -12px rgba(0, 0, 0, 0.25), 0 20px 48px -8px rgba(0, 0, 0, 0.18), 0 12px 24px -4px rgba(0, 0, 0, 0.12), 0 0 0 1px rgba(0, 0, 0, 0.05)'
  ```

### 2. frontend/src/index.css
**保留内容**:
- `@keyframes gradientShift`
- CSS 变量：`--ease-smooth`、`--ease-in-smooth`、`--ease-out-smooth`
- `.gpu-accelerated` 工具类

**删除内容**:
- 所有 `@keyframes float1/float2/float3` 几何浮动动画

### 3. docs/work-plans/2025-10-24/summary.md
**任务状态更新**:
- P1-3 状态改为"进行中"
- 备注添加：今日完成列表→预览动效加速、模式切换平滑化与静态背景优化；比例与设计复核待 Codex 确认

**风险提示添加**:
- 在"遗留事项/风险"中新增：预览视觉调整尚未经过 Codex/设计复核，需确认比例（80%/90%）与最终配色方案

## 技术实现

### 核心改动点
1. **静态背景**: 移除动态几何图形，使用静态渐变
2. **动画优化**: 统一过渡时长，移除不必要的变换
3. **交互改进**: 添加 `pointer-events-none` 提升用户体验
4. **视觉升级**: 16px 圆角 + 四层阴影效果

### 性能优化
- 移除复杂的几何浮动动画，减少 GPU 负载
- 使用 `cubic-bezier(0.4, 0, 0.2, 1)` 缓动函数提升动画流畅度
- 保留 GPU 加速工具类用于关键动画

## 测试验证

### 功能测试
- ✅ 列表→预览淡入时间 < 500ms
- ✅ 切换标准/沉浸模式，图片不抖动、不移动
- ✅ 背景为静态低饱和度蓝灰渐变
- ✅ 圆角 16px、四层阴影效果
- ✅ 工具栏/信息面板/导航按钮过渡流畅

### 浏览器兼容性
- ✅ Chrome/Safari/Firefox 测试通过
- ✅ 移动端响应式适配正常

## 影响范围
- **用户体验**: 预览界面动画更流畅，视觉更统一
- **性能**: 减少不必要的动画计算，提升渲染性能
- **维护性**: 代码结构更清晰，样式更统一

## 后续计划
- 等待 Codex 审计确认比例（80%/90%）与最终配色方案
- 根据审计反馈进行微调优化

## 相关文档
- `docs/work-plans/2025-10-25/cursor-recovery.md` - 恢复指引
- `docs/work-plans/2025-10-25/overview.md` - 工作概览
- `docs/work-plans/2025-10-24/summary.md` - 任务状态更新

## 审计要点
1. **视觉一致性**: 确认背景渐变、圆角、阴影效果符合设计规范
2. **动画流畅性**: 验证过渡时长和缓动函数是否合适
3. **交互体验**: 检查 `pointer-events-none` 的使用是否合理
4. **性能影响**: 评估移除几何动画后的性能提升
5. **代码质量**: 确认样式代码结构清晰，易于维护
