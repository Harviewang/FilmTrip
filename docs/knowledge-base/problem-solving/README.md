# 问题排查与经验总结 (Troubleshooting)

本目录收集了项目开发过程中遇到的重要问题、排查过程和解决方案,用于知识积累和避免重复踩坑。

## 📂 目录结构

```
troubleshooting/
├── README.md                           # 本文档
├── 照片尺寸和方向问题复盘.md            # 瀑布流宽高比问题
└── (更多问题复盘文档...)
```

## 📋 问题清单

### 已解决问题

| 日期 | 问题 | 文档 | 关键词 |
|------|------|------|--------|
| 2025-10-23 | 瀑布流布局使用固定宽高比,照片显示比例不正确 | [照片尺寸和方向问题复盘.md](./照片尺寸和方向问题复盘.md) | EXIF, Orientation, 宽高比, 数据完整性 |
| 2025-10-16 | 图片旋转后预览溢出,方向不一致 | [图片旋转实现最佳实践](../图片旋转实现最佳实践与问题复盘.md) | 图片旋转, CSS Transform, Sharp |

### 待整理问题

- [ ] 上传弹窗高度溢出问题
- [ ] 加密照片Content-Type错误导致无法预览
- [ ] 批量上传时EXIF信息丢失

## 📝 复盘文档规范

每个问题复盘文档应包含以下部分:

### 1. 基本信息
```markdown
**日期**: YYYY-MM-DD
**问题**: 简短描述问题现象
```

### 2. 问题现象
- 用户视角的现象描述
- 错误信息/日志
- 影响范围

### 3. 根本原因
- 技术层面的根本原因
- 为什么会出现这个问题
- 代码/架构层面的缺陷

### 4. 解决方案
- 具体的修复方案
- 关键代码片段
- 数据修复步骤

### 5. 验证测试
- 测试用例
- 验证步骤
- 预期结果

### 6. 预防措施
- 代码层面的改进
- 数据层面的约束
- 运维层面的检查

### 7. 经验教训
- ✅ 做对的事
- ❌ 避免的错误
- 📚 可复用的知识

## 🔍 如何使用

### 遇到问题时
1. 在目录中搜索关键词
2. 查看类似问题的复盘文档
3. 参考解决方案和预防措施

### 解决问题后
1. 创建新的复盘文档
2. 按照规范填写各部分内容
3. 更新本README的问题清单

## 🎯 常见问题索引

### 图片处理相关
- [照片尺寸和方向问题](./照片尺寸和方向问题复盘.md) - EXIF Orientation处理
- [图片旋转实现](../图片旋转实现最佳实践与问题复盘.md) - CSS vs Sharp物理旋转

### 前端布局相关
- [瀑布流宽高比](./照片尺寸和方向问题复盘.md) - 动态计算vs固定值

### 数据完整性相关
- [历史数据迁移](./照片尺寸和方向问题复盘.md) - 批量更新脚本

## 💡 最佳实践提炼

### 1. EXIF处理原则
- ✅ 保留原图EXIF信息,不要强制覆盖
- ✅ 用户手动操作优先级高于自动处理
- ✅ 前端根据EXIF动态计算,不要硬编码

### 2. 数据完整性原则
- ✅ 新增字段时同步更新历史数据
- ✅ 提供数据修复脚本和工具
- ✅ 定期检查数据完整性

### 3. 问题排查方法
1. 查看前端控制台日志
2. 检查后端API返回数据
3. 验证数据库数据正确性
4. 测试实际文件状态

## 📚 相关文档

- [开发日志](../archive/开发日志.md)
- [问题追踪](../archive/问题追踪.md)
- [项目规范总览](../项目规范总览.md)

---

**维护说明**: 
- 每次解决重要问题后,及时创建复盘文档
- 定期review和更新文档,保持内容准确性
- 提炼可复用的最佳实践,避免重复踩坑

